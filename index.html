<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Future Site | Ù…Ù†ØµØ© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ØªØ§Ø¬Ø±</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; margin: 0; background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); color: white; height: 100vh; display: flex; align-items: center; justify-content: center; text-align: center; overflow: hidden; }
        .container { background: rgba(255, 255, 255, 0.1); padding: 40px; border-radius: 20px; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2); width: 90%; max-width: 500px; }
        h1 { font-size: 3rem; margin-bottom: 10px; background: linear-gradient(to right, #00f2fe, #4facfe); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .btn-group { display: flex; flex-direction: column; gap: 15px; }
        .btn { padding: 15px 30px; border-radius: 50px; border: none; font-size: 1.1rem; font-weight: bold; cursor: pointer; transition: 0.3s; text-decoration: none; }
        .btn-primary { background: #4facfe; color: white; box-shadow: 0 4px 15px rgba(79, 172, 254, 0.4); }
        .btn-secondary { background: white; color: #1e3c72; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6); backdrop-filter: blur(5px); }
        .modal-content { background: white; margin: 10% auto; padding: 30px; border-radius: 20px; width: 85%; max-width: 400px; color: #333; text-align: right; position: relative; animation: slideIn 0.4s; }
        @keyframes slideIn { from { transform: translateY(-50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .close { position: absolute; left: 20px; top: 15px; font-size: 28px; cursor: pointer; color: #999; }
        input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 10px; box-sizing: border-box; font-family: 'Cairo'; }
        .submit-btn { width: 100%; padding: 15px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; font-size: 1rem; margin-top: 10px; }
        .reg-btn { background: #4facfe; color: white; }
        .log-btn { background: #1e3c72; color: white; }
    </style>
</head>
<body>

    <div class="container">
        <div style="font-size: 50px;">ğŸš€</div>
        <h1>Future Site</h1>
        <p>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…Ø³ØªÙ‚Ø¨Ù„ Ø§Ù„ØªØ¬Ø§Ø±Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</p>
        <div class="btn-group">
            <button class="btn btn-primary" onclick="openModal('registerModal')">Ø§Ù†Ø´Ø¦ Ù…ØªØ¬Ø±Ùƒ Ø§Ù„Ø¢Ù†</button>
            <button class="btn btn-secondary" onclick="openModal('loginModal')">Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ù…ØªØ¬Ø±ÙŠ</button>
        </div>
    </div>

    <div id="registerModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('registerModal')">&times;</span>
            <h2 style="color: #4facfe;">âœ¨ Ø¥Ù†Ø´Ø§Ø¡ Ù…ØªØ¬Ø± Ø¬Ø¯ÙŠØ¯</h2>
            <input type="text" id="regName" placeholder="Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù„Ù‚Ø¨">
            <input type="text" id="regStoreName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¬Ø±">
            <input type="email" id="regEmail" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
            <input type="password" id="regPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
            <button class="submit-btn reg-btn" onclick="registerUser()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù† ğŸš€</button>
        </div>
    </div>

    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('loginModal')">&times;</span>
            <h2 style="color: #1e3c72;">ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
            <input type="email" id="loginEmail" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
            <input type="password" id="loginPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
            <button class="submit-btn log-btn" onclick="loginUser()">Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…ØªØ¬Ø± âœ…</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getDatabase, ref, push, set, onValue } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDCdnCI1cKdR4wvU2Y_cnw9essx1MYgA2w",
            authDomain: "futuresite-74037.firebaseapp.com",
            databaseURL: "https://futuresite-74037-default-rtdb.firebaseio.com",
            projectId: "futuresite-74037",
            storageBucket: "futuresite-74037.firebasestorage.app",
            messagingSenderId: "643691438622",
            appId: "1:643691438622:web:78f958cb5ba52a6069c40f"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // Ø¬Ø¹Ù„ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ù…ØªØ§Ø­Ø© Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹ Ù„Ù€ HTML
        window.openModal = (id) => { document.getElementById(id).style.display = "block"; };
        window.closeModal = (id) => { document.getElementById(id).style.display = "none"; };

        // ÙˆØ¸ÙŠÙØ© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ØªØ¬Ø±
        window.registerUser = function() {
            const name = document.getElementById('regName').value.trim();
            const storeName = document.getElementById('regStoreName').value.trim();
            const email = document.getElementById('regEmail').value.trim();
            const pass = document.getElementById('regPass').value.trim();

            if(!name || !storeName || !email || !pass) {
                alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø§Ù†Ø§Øª!");
                return;
            }

            const newStoreRef = push(ref(db, 'stores'));
            set(newStoreRef, {
                ownerName: name,
                name: storeName,
                email: email,
                password: pass,
                status: 'Ù…Ø¹Ø·Ù„', 
                isPublic: false,
                productsCount: 0,
                ordersCount: 0,
                expiryDate: 0 
            }).then(() => {
                alert("ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­!");
                localStorage.setItem('myStoreId', newStoreRef.key);
                location.href = 'user-dashboard.html';
            }).catch(err => alert("Ø­Ø¯Ø« Ø®Ø·Ø£: " + err.message));
        };

        // ÙˆØ¸ÙŠÙØ© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        window.loginUser = function() {
            const emailInput = document.getElementById('loginEmail').value.trim();
            const passInput = document.getElementById('loginPass').value.trim();

            if(!emailInput || !passInput) {
                alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ ÙˆØ§Ù„Ø¨Ø§Ø³ÙˆÙˆØ±Ø¯!");
                return;
            }

            const storesRef = ref(db, 'stores');
            onValue(storesRef, (snapshot) => {
                const stores = snapshot.val();
                let found = false;
                
                if(stores) {
                    for (let id in stores) {
                        if (stores[id].email === emailInput && stores[id].password === passInput) {
                            found = true;
                            localStorage.setItem('myStoreId', id);
                            alert("Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ Ù…Ø¬Ø¯Ø¯Ø§Ù‹!");
                            location.href = 'user-dashboard.html';
                            break;
                        }
                    }
                }
                
                if (!found) alert("Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©!");
            }, { onlyOnce: true });
        };

        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø®Ø§Ø±Ø¬Ù‡
        window.onclick = function(event) {
            if (event.target.className === 'modal') { event.target.style.display = "none"; }
        };
    </script>
</body>
</html>
